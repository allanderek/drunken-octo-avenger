// Generated by CoffeeScript 1.9.0
(function() {
  var $new_stone, coordFromChr, coordRe, game_basic, hasCoordClass, new_stone_image_path, parseCoordClass, set_image, tesuji_charm;

  if (window.tesuji_charm == null) {
    window.tesuji_charm = {};
  }

  tesuji_charm = window.tesuji_charm;

  if (tesuji_charm.game_basic == null) {
    tesuji_charm.game_basic = {};
  }

  game_basic = tesuji_charm.game_basic;

  $new_stone = null;

  new_stone_image_path = null;

  set_image = function($td, filename) {
    return $td.find('img').attr('src', "static/images/goban/" + filename);
  };

  coordFromChr = function(chr) {
    return chr.charCodeAt(0) - 'a'.charCodeAt(0);
  };

  coordRe = /coord-(\w)(\w)/;

  hasCoordClass = function($obj) {
    return coordRe.test($obj.attr("class"));
  };

  parseCoordClass = function($obj) {
    var colStr, rowStr, _, _ref;
    _ref = coordRe.exec($obj.attr("class")), _ = _ref[0], rowStr = _ref[1], colStr = _ref[2];
    return [coordFromChr(rowStr), coordFromChr(colStr)];
  };

  game_basic.initialize = function() {
    if (parseInt($('input#move_no').val()) % 2 === 0) {
      new_stone_image_path = 'b.gif';
    } else {
      new_stone_image_path = 'w.gif';
    }
    $('button.confirm_button').prop('disabled', true);
    return $('table.goban td').click(function() {
      var $old_new_stone, col, row, _ref;
      if (!hasCoordClass($(this))) {
        return;
      }
      $old_new_stone = $new_stone;
      $new_stone = $(this);
      if ($old_new_stone !== null) {
        set_image($old_new_stone, 'e.gif');
      }
      set_image($new_stone, new_stone_image_path);
      _ref = parseCoordClass($new_stone), row = _ref[0], col = _ref[1];
      $('input#row').val(row.toString());
      $('input#column').val(col.toString());
      return $('button.confirm_button').prop('disabled', false);
    });
  };

}).call(this);
